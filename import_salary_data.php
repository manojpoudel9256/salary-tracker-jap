<?php
include 'auth/protected.php'; // Ensure the user is logged in
include 'config/db.php';      // Connect to DB

$user_id = $_SESSION['user_id']; // Get logged-in user's ID

// Salary data array: [store_name, received_date, working_month, amount]
$salary_data = [
    ['Family Mart', '2022-06-10', '2022-05-01', 54000],
    ['7-Eleven',    '2022-06-25', '2022-05-01', 76000],
    ['Family Mart', '2022-07-10', '2022-06-01', 80000],
    ['7-Eleven',    '2022-07-25', '2022-06-01', 100000],
    ['Family Mart', '2022-08-10', '2022-07-01', 120000],
    ['7-Eleven',    '2022-08-25', '2022-07-01', 85000],
    ['Family Mart', '2022-09-10', '2022-08-01', 96000],
    ['7-Eleven',    '2022-09-25', '2022-08-01', 9000],
    ['Family Mart', '2022-10-10', '2022-09-01', 79000],
    ['7-Eleven',    '2022-10-25', '2022-09-01', 99000],
    ['Family Mart', '2022-11-10', '2022-10-01', 125000],
    ['7-Eleven',    '2022-11-25', '2022-10-01', 100000],
    ['Family Mart', '2022-12-10', '2022-11-01', 131000],
    ['7-Eleven',    '2022-12-25', '2022-11-01', 105000],
    ['Family Mart', '2023-01-10', '2022-12-01', 142000],
    ['7-Eleven',    '2023-01-25', '2022-12-01', 101000],
    ['Family Mart', '2023-02-10', '2023-01-01', 123000],
    ['7-Eleven',    '2023-02-25', '2023-01-01', 85000],
    ['Family Mart', '2023-03-10', '2023-02-01', 124000],
    ['7-Eleven',    '2023-03-25', '2023-02-01', 71000],
    ['Family Mart', '2023-04-10', '2023-03-01', 120000],
    ['7-Eleven',    '2023-04-25', '2023-03-01', 85000],
    ['Family Mart', '2023-05-10', '2023-04-01', 91000],
    ['7-Eleven',    '2023-05-25', '2023-04-01', 74000],
    ['Family Mart', '2023-06-10', '2023-05-01', 108000],
    ['7-Eleven',    '2023-06-25', '2023-05-01', 85000],
    ['Family Mart', '2023-07-10', '2023-06-01', 111000],
    ['7-Eleven',    '2023-07-25', '2023-06-01', 105000],
    ['Family Mart', '2023-08-10', '2023-07-01', 101000],
    ['7-Eleven',    '2023-08-25', '2023-07-01', 85000],
    ['Family Mart', '2023-09-10', '2023-08-01', 130000],
    ['7-Eleven',    '2023-09-25', '2023-08-01', 95000],
    ['Family Mart', '2023-10-10', '2023-09-01', 135000],
    ['7-Eleven',    '2023-10-25', '2023-09-01', 95000],
    ['Family Mart', '2023-11-10', '2023-10-01', 140000],
    ['7-Eleven',    '2023-11-25', '2023-10-01', 85000],
    ['Family Mart', '2023-12-10', '2023-11-01', 140000],
    ['7-Eleven',    '2023-12-25', '2023-11-01', 0],
    ['Family Mart', '2024-01-10', '2023-12-01', 140000],
    ['7-Eleven',    '2024-01-25', '2023-12-01', 0],
    ['Family Mart', '2024-02-10', '2024-01-01', 152000],
    ['7-Eleven',    '2024-02-25', '2024-01-01', 103000],
    ['Family Mart', '2024-03-10', '2024-02-01', 130000],
    ['7-Eleven',    '2024-03-25', '2024-02-01', 6000],
    ['Family Mart', '2024-04-10', '2024-03-01', 140000],
    ['7-Eleven',    '2024-04-25', '2024-03-01', 84000],
    ['Family Mart', '2024-05-10', '2024-04-01', 120000],
    ['7-Eleven',    '2024-05-25', '2024-04-01', 84000],
    ['Family Mart', '2024-06-10', '2024-05-01', 133000],
    ['7-Eleven',    '2024-06-25', '2024-05-01', 94000],
    ['Family Mart', '2024-07-10', '2024-06-01', 135000],
    ['7-Eleven',    '2024-07-25', '2024-06-01', 94000],
    ['Family Mart', '2024-08-10', '2024-07-01', 144000],
    ['7-Eleven',    '2024-08-25', '2024-07-01', 88000],
    ['Family Mart', '2024-09-10', '2024-08-01', 132000],
    ['7-Eleven',    '2024-09-25', '2024-08-01', 105000],
    ['Family Mart', '2024-10-10', '2024-09-01', 121000],
    ['7-Eleven',    '2024-10-25', '2024-09-01', 80000],
    ['Family Mart', '2024-11-10', '2024-10-01', 133000],
    ['7-Eleven',    '2024-11-25', '2024-10-01', 93000],
    ['Family Mart', '2024-12-10', '2024-11-01', 142000],
    ['7-Eleven',    '2024-12-25', '2024-11-01', 105000],
    ['Family Mart', '2025-01-10', '2024-12-01', 130000],
    ['7-Eleven',    '2025-01-25', '2024-12-01', 170000],
    ['Family Mart', '2025-02-10', '2025-01-01', 130000],
    ['7-Eleven',    '2025-02-25', '2025-01-01', 114000],
    ['Family Mart', '2025-03-10', '2025-02-01', 122000],
    ['7-Eleven',    '2025-03-25', '2025-02-01', 93000],
    ['Family Mart', '2025-04-10', '2025-03-01', 140000]
];

try {
    $pdo->beginTransaction();

    $stmt = $pdo->prepare("INSERT INTO salaries (store_name, received_date, working_month, amount, user_id) VALUES (?, ?, ?, ?, ?)");

    foreach ($salary_data as $entry) {
        $stmt->execute([$entry[0], $entry[1], $entry[2], $entry[3], $user_id]);
    }

    $pdo->commit();

    echo "✅ Salary history imported successfully!";
} catch (Exception $e) {
    $pdo->rollBack();
    echo "❌ Error importing data: " . $e->getMessage();
}
?>
